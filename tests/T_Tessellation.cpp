#include "gtest/gtest.h"
#include "NurbsCurve.h"
#include "NurbsSurface.h"
#include "XYZ.h"
#include "XYZW.h"
#include "MathUtils.h"
#include "Voronoi.h"
#include "LNObject.h"

using namespace LNLib;

TEST(Test_Tessellation, Curve)
{
	XYZ center = XYZ(0, 0, 0);
	XYZ xAxis = XYZ(1, 0, 0);
	XYZ yAxis = XYZ(0, 1, 0);
	double radius = 100;
	LN_NurbsCurve curve;
	bool createArc = NurbsCurve::CreateArc(center, xAxis, yAxis, 0, 2 * Constants::Pi, radius, radius, curve);
	std::vector<double> knots = curve.KnotVector;
	std::vector<XYZ> points = NurbsCurve::Tessellate(curve);
	EXPECT_TRUE(points.size() > 0);
	EXPECT_TRUE(points[0].IsAlmostEqualTo(NurbsCurve::GetPointOnCurve(curve, knots[0])));
	EXPECT_TRUE(points[points.size()-1].IsAlmostEqualTo(NurbsCurve::GetPointOnCurve(curve, knots[knots.size()-1])));
}

TEST(Test_Tessellation, R)
{
    int degree = 3;
    std::vector<LNLib::XYZW> controlpoints2;
    controlpoints2.push_back(LNLib::XYZW(-264.274, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-265.272, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.87, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.324, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.323, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.322, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.32, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.317, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.314, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.31, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.306, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.302, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.297, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.291, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.286, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.28, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.552, 19.5688, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.369, 19.3737, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.38, 18.9725, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.38, 18.9725, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.38, 18.8004, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.38, 18.6288, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.369, 18.4567, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.369, 18.4567, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.357, 18.2964, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.346, 18.1818, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.323, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.323, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.323, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1244, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1928, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1928, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.818, 18.1928, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.944, 18.2389, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.99, 18.3422, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.967, 18.5255, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.967, 18.5255, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.967, 18.5255, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.002, 19.1332, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.002, 19.1332, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.002, 19.1332, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.013, 19.4769, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.128, 19.6833, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.346, 19.7748, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.346, 19.7748, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.07, 19.9355, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.933, 20.1995, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.933, 20.5772, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.933, 20.5772, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-262.944, 21.1621, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.265, 21.4605, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-263.908, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 21.4832, 0, 1));
    controlpoints2.push_back(LNLib::XYZW(-264.274, 21.4832, 0, 1));

    std::vector<double> knots2;
    knots2.push_back(0);
    knots2.push_back(0);
    knots2.push_back(0);
    knots2.push_back(0);
    knots2.push_back(0.0222222);
    knots2.push_back(0.0222222);
    knots2.push_back(0.0222222);
    knots2.push_back(0.0222222);
    knots2.push_back(0.0444444);
    knots2.push_back(0.0444444);
    knots2.push_back(0.0444444);
    knots2.push_back(0.0444444);
    knots2.push_back(0.0666667);
    knots2.push_back(0.0666667);
    knots2.push_back(0.0666667);
    knots2.push_back(0.0666667);
    knots2.push_back(0.0888889);
    knots2.push_back(0.0888889);
    knots2.push_back(0.0888889);
    knots2.push_back(0.0888889);
    knots2.push_back(0.111111);
    knots2.push_back(0.111111);
    knots2.push_back(0.111111);
    knots2.push_back(0.111111);
    knots2.push_back(0.133333);
    knots2.push_back(0.133333);
    knots2.push_back(0.133333);
    knots2.push_back(0.133333);
    knots2.push_back(0.155556);
    knots2.push_back(0.155556);
    knots2.push_back(0.155556);
    knots2.push_back(0.155556);
    knots2.push_back(0.177778);
    knots2.push_back(0.177778);
    knots2.push_back(0.177778);
    knots2.push_back(0.177778);
    knots2.push_back(0.2);
    knots2.push_back(0.2);
    knots2.push_back(0.2);
    knots2.push_back(0.2);
    knots2.push_back(0.222222);
    knots2.push_back(0.222222);
    knots2.push_back(0.222222);
    knots2.push_back(0.222222);
    knots2.push_back(0.244444);
    knots2.push_back(0.244444);
    knots2.push_back(0.244444);
    knots2.push_back(0.244444);
    knots2.push_back(0.266667);
    knots2.push_back(0.266667);
    knots2.push_back(0.266667);
    knots2.push_back(0.266667);
    knots2.push_back(0.288889);
    knots2.push_back(0.288889);
    knots2.push_back(0.288889);
    knots2.push_back(0.288889);
    knots2.push_back(0.311111);
    knots2.push_back(0.311111);
    knots2.push_back(0.311111);
    knots2.push_back(0.311111);
    knots2.push_back(0.333333);
    knots2.push_back(0.333333);
    knots2.push_back(0.333333);
    knots2.push_back(0.333333);
    knots2.push_back(0.355556);
    knots2.push_back(0.355556);
    knots2.push_back(0.355556);
    knots2.push_back(0.355556);
    knots2.push_back(0.377778);
    knots2.push_back(0.377778);
    knots2.push_back(0.377778);
    knots2.push_back(0.377778);
    knots2.push_back(0.4);
    knots2.push_back(0.4);
    knots2.push_back(0.4);
    knots2.push_back(0.4);
    knots2.push_back(0.422222);
    knots2.push_back(0.422222);
    knots2.push_back(0.422222);
    knots2.push_back(0.422222);
    knots2.push_back(0.444444);
    knots2.push_back(0.444444);
    knots2.push_back(0.444444);
    knots2.push_back(0.444444);
    knots2.push_back(0.466667);
    knots2.push_back(0.466667);
    knots2.push_back(0.466667);
    knots2.push_back(0.466667);
    knots2.push_back(0.488889);
    knots2.push_back(0.488889);
    knots2.push_back(0.488889);
    knots2.push_back(0.488889);
    knots2.push_back(0.511111);
    knots2.push_back(0.511111);
    knots2.push_back(0.511111);
    knots2.push_back(0.511111);
    knots2.push_back(0.533333);
    knots2.push_back(0.533333);
    knots2.push_back(0.533333);
    knots2.push_back(0.533333);
    knots2.push_back(0.555556);
    knots2.push_back(0.555556);
    knots2.push_back(0.555556);
    knots2.push_back(0.555556);
    knots2.push_back(0.577778);
    knots2.push_back(0.577778);
    knots2.push_back(0.577778);
    knots2.push_back(0.577778);
    knots2.push_back(0.6);
    knots2.push_back(0.6);
    knots2.push_back(0.6);
    knots2.push_back(0.6);
    knots2.push_back(0.622222);
    knots2.push_back(0.622222);
    knots2.push_back(0.622222);
    knots2.push_back(0.622222);
    knots2.push_back(0.644444);
    knots2.push_back(0.644444);
    knots2.push_back(0.644444);
    knots2.push_back(0.644444);
    knots2.push_back(0.666667);
    knots2.push_back(0.666667);
    knots2.push_back(0.666667);
    knots2.push_back(0.666667);
    knots2.push_back(0.688889);
    knots2.push_back(0.688889);
    knots2.push_back(0.688889);
    knots2.push_back(0.688889);
    knots2.push_back(0.711111);
    knots2.push_back(0.711111);
    knots2.push_back(0.711111);
    knots2.push_back(0.711111);
    knots2.push_back(0.733333);
    knots2.push_back(0.733333);
    knots2.push_back(0.733333);
    knots2.push_back(0.733333);
    knots2.push_back(0.755556);
    knots2.push_back(0.755556);
    knots2.push_back(0.755556);
    knots2.push_back(0.755556);
    knots2.push_back(0.777778);
    knots2.push_back(0.777778);
    knots2.push_back(0.777778);
    knots2.push_back(0.777778);
    knots2.push_back(0.8);
    knots2.push_back(0.8);
    knots2.push_back(0.8);
    knots2.push_back(0.8);
    knots2.push_back(0.822222);
    knots2.push_back(0.822222);
    knots2.push_back(0.822222);
    knots2.push_back(0.822222);
    knots2.push_back(0.844444);
    knots2.push_back(0.844444);
    knots2.push_back(0.844444);
    knots2.push_back(0.844444);
    knots2.push_back(0.866667);
    knots2.push_back(0.866667);
    knots2.push_back(0.866667);
    knots2.push_back(0.866667);
    knots2.push_back(0.888889);
    knots2.push_back(0.888889);
    knots2.push_back(0.888889);
    knots2.push_back(0.888889);
    knots2.push_back(0.911111);
    knots2.push_back(0.911111);
    knots2.push_back(0.911111);
    knots2.push_back(0.911111);
    knots2.push_back(0.933333);
    knots2.push_back(0.933333);
    knots2.push_back(0.933333);
    knots2.push_back(0.933333);
    knots2.push_back(0.955556);
    knots2.push_back(0.955556);
    knots2.push_back(0.955556);
    knots2.push_back(0.955556);
    knots2.push_back(0.977778);
    knots2.push_back(0.977778);
    knots2.push_back(0.977778);
    knots2.push_back(0.977778);
    knots2.push_back(1);
    knots2.push_back(1);
    knots2.push_back(1);
    knots2.push_back(1);

    LNLib::LN_NurbsCurve curve;
    curve.Degree = degree;
    curve.KnotVector = knots2;
    curve.ControlPoints = controlpoints2;

    std::vector<XYZ> pts = NurbsCurve::Tessellate(curve);
    int size = pts.size();
    double length = 0.0;
    for (int i = 0; i < size - 1; i++)
    {
        LNLib::XYZ t0 = pts[i];
        LNLib::XYZ t1 = pts[i + 1];
        length += t0.Distance(t1);
    }
    EXPECT_TRUE(MathUtils::IsAlmostEqualTo(length, 14.117712));
    EXPECT_TRUE(NurbsCurve::GetPointOnCurve(curve, 0.333333).IsAlmostEqualTo(XYZ(-265.27199999999999, 21.4832, 0.0)));
    EXPECT_TRUE(NurbsCurve::GetPointOnCurve(curve, 0.355556).IsAlmostEqualTo(XYZ(-265.27199999999999, 18.1244, 0.0)));
    EXPECT_TRUE(NurbsCurve::GetPointOnCurve(curve, 0.377778).IsAlmostEqualTo(XYZ(-264.87, 18.1244, 0.0)));
    EXPECT_TRUE(NurbsCurve::GetPointOnCurve(curve, 0.4).IsAlmostEqualTo(XYZ(-264.87, 19.5688, 0.0)));
}

TEST(Test_Tessellation, Voronoi)
{
	float xValues[4] = { -22, -17, 4,22 };
	float yValues[4] = { -9, 31,13,-5 };

	long count = 4;

	VoronoiDiagramGenerator vdg;
	vdg.setGenerateVoronoi(true);
	vdg.setGenerateDelaunay(true);
	vdg.generateVoronoi(xValues, yValues, count, -100, 100, -100, 100, 0);
	vdg.resetDelaunayEdgesIterator();

	float x1, y1, x2, y2;
	int edges = 0;
	while (vdg.getNextDelaunay(x1, y1, x2, y2))
	{
		edges++;
	}
	EXPECT_TRUE(edges == 5);

	std::vector<std::vector<int>> triangles =  vdg.getTriangles();
	EXPECT_TRUE(triangles.size() == 2);
}

TEST(Test_Tessellation, Surface)
{
	int degreeU = 3;
	int degreeV = 3;
	std::vector<double> kvU = { 0,0,0,0,0.4,0.6,1,1,1,1 };
	std::vector<double> kvV = { 0,0,0,0,0.4,0.6,1,1,1,1 };
	std::vector<std::vector<XYZW>> controlPoints(6, std::vector<XYZW>(6));

	controlPoints[0][0] = XYZW(0, 0, 0, 1);
	controlPoints[0][1] = XYZW(6.666666, 0, 4, 1);
	controlPoints[0][2] = XYZW(16.666666, 0, 22, 1);
	controlPoints[0][3] = XYZW(33.333333, 0, 22, 1);
	controlPoints[0][4] = XYZW(43.333333, 0, 4, 1);
	controlPoints[0][5] = XYZW(50, 0, 0, 1);

	controlPoints[1][0] = XYZW(0, 6.666667, 0, 1);
	controlPoints[1][1] = XYZW(6.6666667, 6.666667, 9.950068, 1);
	controlPoints[1][2] = XYZW(16.6666666, 6.666667, 9.65541838, 1);
	controlPoints[1][3] = XYZW(33.3333333, 6.666667, 47.21371742, 1);
	controlPoints[1][4] = XYZW(43.3333333, 6.666667, -11.56982167, 1);
	controlPoints[1][5] = XYZW(50, 6.6666667, 0, 1);

	controlPoints[2][0] = XYZW(0, 16.666666, 0, 1);
	controlPoints[2][1] = XYZW(6.6666667, 16.666666, -7.9001371, 1);
	controlPoints[2][2] = XYZW(16.6666666, 16.666666, 46.6891632, 1);
	controlPoints[2][3] = XYZW(33.3333333, 16.666667, -28.4274348, 1);
	controlPoints[2][4] = XYZW(43.3333333, 16.666667, 35.1396433, 1);
	controlPoints[2][5] = XYZW(50, 16.6666667, 0, 1);

	controlPoints[3][0] = XYZW(0, 33.3333333, 0, 1);
	controlPoints[3][1] = XYZW(6.6666667, 33.3333333, 29.2877911, 1);
	controlPoints[3][2] = XYZW(16.6666666, 33.3333333, -30.4644718, 1);
	controlPoints[3][3] = XYZW(33.3333333, 33.3333333, 129.1582990, 1);
	controlPoints[3][4] = XYZW(43.3333333, 33.3333333, -62.1717142, 1);
	controlPoints[3][5] = XYZW(50, 33.333333, 0, 1);

	controlPoints[4][0] = XYZW(0, 43.333333, 0, 1);
	controlPoints[4][1] = XYZW(6.6666667, 43.333333, -10.384636, 1);
	controlPoints[4][2] = XYZW(16.6666666, 43.333333, 59.21371742, 1);
	controlPoints[4][3] = XYZW(33.3333333, 43.333333, -37.7272976, 1);
	controlPoints[4][4] = XYZW(43.3333333, 43.333333, 45.1599451, 1);
	controlPoints[4][5] = XYZW(50, 43.333333, 0, 1);

	controlPoints[5][0] = XYZW(0, 50, 0, 1);
	controlPoints[5][1] = XYZW(6.6666667, 50, 0, 1);
	controlPoints[5][2] = XYZW(16.6666666, 50, 0, 1);
	controlPoints[5][3] = XYZW(33.3333333, 50, 0, 1);
	controlPoints[5][4] = XYZW(43.3333333, 50, 0, 1);
	controlPoints[5][5] = XYZW(50, 50, 0, 1);

	LN_NurbsSurface surface;
	surface.DegreeU = degreeU;
	surface.DegreeV = degreeV;
	surface.KnotVectorU = kvU;
	surface.KnotVectorV = kvV;
	surface.ControlPoints = controlPoints;

	LNLib::LN_Mesh mesh1 = NurbsSurface::Triangulate(surface, 25, 25, true);
	EXPECT_TRUE(mesh1.Faces.size() != 0);

	LNLib::LN_Mesh mesh2 = NurbsSurface::Triangulate(surface, 1000, 1000, false);
	EXPECT_TRUE(mesh2.Faces.size() != 0);
}
